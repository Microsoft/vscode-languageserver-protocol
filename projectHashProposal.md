# LSIF: ProjectWithHash

Formulating and processing LSIF for large repositories can be very time consuming. We've discovered that many commits touch only ~20% of projects in a given repository, so there can be lots of unnecessary processing done on unchanged projects that are then ignored at ingestion time. To decrease processing times, I propose adding a new "projectHash" property to the existing [project vertex](https://github.com/Microsoft/language-server-protocol/blob/master/indexFormat/specification.md#the-project-vertex). The new definition for the `project` vertex would be:

```ts
export interface ProjectWithHash extends Project {
    /**
     * An optional hash of the files included in the project, `base64` encoded.
     */
    projectHash?: string;
}
```

Individual languages can decide what is the most reasonable selection for this project hash. For C#, this could be the MVID of the project assembly. For typescript, this could be a hash of the contents of all files included in the tsconfig.json. This `projectHash` property can then be compared against an existing cache of project hashes for the given repository to determine if the content has changed and the project needs to be re-ingested.

# LSIF Indexers: Application

LSIF indexers can use this `projectHash` property while constructing .zip files on the build machine to determine which projects have changed. LSIF language tools should take an optional process parameter `projectHash` that represents the existing hash that the indexer has stored for the current project. If the project hash provided by indexer matches the project hash generated by the LSIF tool, execution of the tool can be halted and no LSIF needs to be output for processing for that project. In the event that no `projectHash` parameter is passed to the LSIF tool, the LSIF indexer should examine the `projectHash` property set on the project node and determine for itself if the project needs to be ingested, ending the LSIF tool process if the project is indeed a duplicate.
